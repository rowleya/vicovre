<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

    <bean id="rtpTypeRepository" class="com.googlecode.vicovre.repositories.rtptype.impl.RtpTypeRepositoryXmlImpl">
        <constructor-arg><value>/rtptypes.xml</value></constructor-arg>
    </bean>

    <bean id="layoutRepository" class="com.googlecode.vicovre.repositories.layout.impl.LayoutRepositoryXmlImpl">
        <constructor-arg><value>/layouts.xml</value></constructor-arg>
    </bean>

    <bean id="editableLayoutRepository" class="com.googlecode.vicovre.repositories.layout.impl.EditableLayoutRepositoryXmlImpl">
        <constructor-arg><ref bean="layoutRepository"/></constructor-arg>
        <constructor-arg><value>${layout.location}</value></constructor-arg>
    </bean>

    <bean id="harvestFormatRepository" class="com.googlecode.vicovre.repositories.harvestFormat.impl.HarvestFormatRepositoryXmlImpl">
        <constructor-arg><value>/harvestFormats.xml</value></constructor-arg>
    </bean>

    <bean id="liveAnnotationTypeRepository" class="com.googlecode.vicovre.repositories.liveAnnotation.impl.LiveAnnotationTypeRepositoryXmlImpl">
        <constructor-arg><value>/liveannotations.xml</value></constructor-arg>
    </bean>

    <bean id="emailer" class="com.googlecode.vicovre.utils.Emailer">
        <constructor-arg><value>${email.server.host}</value></constructor-arg>
        <constructor-arg><value>${email.server.port}</value></constructor-arg>
        <constructor-arg><value>${email.from}</value></constructor-arg>
        <constructor-arg><value>${admin}</value></constructor-arg>
    </bean>

    <bean id="insecureDatabase" class="com.googlecode.vicovre.recordings.db.insecure.InsecureRecordingDatabase">
        <constructor-arg><value>${recording.location}</value></constructor-arg>
        <constructor-arg><ref bean="rtpTypeRepository"/></constructor-arg>
        <constructor-arg><ref bean="layoutRepository"/></constructor-arg>
        <constructor-arg><ref bean="harvestFormatRepository"/></constructor-arg>
        <constructor-arg><value>${recording.readOnly}</value></constructor-arg>
        <constructor-arg><value>0</value></constructor-arg>
    </bean>

    <bean id="realm" class="java.lang.String">
        <constructor-arg><value>${security.realm}</value></constructor-arg>
    </bean>

    <bean id="securityDatabase" class="com.googlecode.vicovre.security.db.SecurityDatabase">
        <constructor-arg><value>${security.location}</value></constructor-arg>
        <constructor-arg><ref bean="emailer"/></constructor-arg>
    </bean>

    <bean id="database" class="com.googlecode.vicovre.recordings.db.secure.SecureRecordingDatabase" destroy-method="shutdown">
        <constructor-arg><ref bean="insecureDatabase"/></constructor-arg>
        <constructor-arg><ref bean="securityDatabase"/></constructor-arg>
    </bean>

    <bean id="harvester" class="com.googlecode.vicovre.recordings.Harvester" destroy-method="shutdown">
        <constructor-arg><ref bean="database"/></constructor-arg>
    </bean>

    <bean id="unfinishedRecordingController" class="com.googlecode.vicovre.recordings.UnfinishedRecordingController" destroy-method="shutdown">
        <constructor-arg><ref bean="database"/></constructor-arg>
        <constructor-arg><ref bean="rtpTypeRepository"/></constructor-arg>
        <constructor-arg><ref bean="layoutRepository"/></constructor-arg>
        <constructor-arg><ref bean="emailer"/></constructor-arg>
    </bean>

    <bean id="recordingLifetimeHandler" class="com.googlecode.vicovre.recordings.RecordingLifetimeHandler" destroy-method="shutdown">
        <constructor-arg><ref bean="database"/></constructor-arg>
        <constructor-arg><ref bean="emailer"/></constructor-arg>
    </bean>

    <bean id="backupHandler" class="com.googlecode.vicovre.recordings.BackupHandler" destroy-method="shutdown">
        <constructor-arg><value>${recording.backup.location}</value></constructor-arg>
        <constructor-arg><ref bean="insecureDatabase"/></constructor-arg>
        <constructor-arg><value>${recording.backup.enabled}</value></constructor-arg>
    </bean>
    <bean id="backupSecurityHandler" class="com.googlecode.vicovre.recordings.BackupSecurityHandler" destroy-method="shutdown">
        <constructor-arg><value>${security.location}</value></constructor-arg>
        <constructor-arg><value>${security.backup.location}</value></constructor-arg>
        <constructor-arg><ref bean="securityDatabase"/></constructor-arg>
        <constructor-arg><value>${security.backup.enabled}</value></constructor-arg>
    </bean>

    <bean id="convertSessionManager" class="com.googlecode.vicovre.web.convert.ConvertSessionManager">
    </bean>

    <bean id="defaultAudioRtpType" class="java.lang.Integer">
        <constructor-arg><value>84</value></constructor-arg>
    </bean>

    <bean id="defaultVideoRtpType" class="java.lang.Integer">
        <constructor-arg><value>96</value></constructor-arg>
    </bean>

    <bean id="defaultAGAudioRtpType" class="java.lang.Integer">
        <constructor-arg><value>112</value></constructor-arg>
    </bean>

    <bean id="defaultAGVideoRtpType" class="java.lang.Integer">
        <constructor-arg><value>31</value></constructor-arg>
    </bean>

    <!-- Annotations implementation - comment out to ignore annotations -->
    <bean id="profileRepository" class="org.caboto.profile.ProfileRepositoryXmlImpl">
        <constructor-arg index="0" value="profiles.xml"/>
    </bean>

    <bean id="cabotoDatabase" class="org.caboto.jena.db.impl.SDBDatabase">
        <constructor-arg index="0" value="caboto.db"/>
        <constructor-arg index="1" value="/caboto.properties"/>
    </bean>

    <bean id="annotationDao" class="org.caboto.dao.AnnotationDaoImpl">
        <constructor-arg index="0" ref="profileRepository"/>
        <constructor-arg index="1" ref="cabotoDatabase"/>
    </bean>

    <bean id="namespaces" class="java.util.HashMap">
        <constructor-arg>
            <map>
            </map>
        </constructor-arg>
    </bean>

    <bean id="metadataMap" class="java.util.HashMap">
        <constructor-arg>
            <map>
            </map>
        </constructor-arg>
    </bean>
</beans>