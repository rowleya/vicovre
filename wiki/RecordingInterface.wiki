#summary Description of the REST interface for controlling Recordings

= Introduction =

This page describes the REST interface used to list, create, edit, delete, start, stop, pause and resume recordings.

= Details =

|| *HTTP Method* || *URL Format* || *Description* || *Return Content Types* || *Return Entity* ||
|| GET || {{{http://<url>/record/<folder>}}} || Gets a list of the recordings in the given folder.  If no folder is specified, the root directory of the recordings is listed. || text/xml, application/json || The list of recordings - see below for formatting. ||
|| POST || {{{http://<url>/record/<folder>?<details>}}} || Creates a new recording in the specified folder. See below for what can be specified in {{{<details>}}}. || text/plain || The full url of the new recording. ||
|| PUT || {{{http://<url>/record/<folder>/<id>?<details>}}} || Edits the recording with the given url. See below for what can be specified in {{{<details>}}}. || None || None ||
|| DELETE || {{{http://<url>/record/<folder>/<id>}}} || Deletes the recording with the given url. || None || None ||
|| PUT || {{{http://<url>/record/<folder>/<id>/start}}} || Starts the recording with the given url. || None || None ||
|| PUT || {{{http://<url>/record/<folder>/<id>/stop}}} || Stops the recording with the given url. || None || None ||
|| PUT || {{{http://<url>/record/<folder>/<id>/pause}}} || Pauses the recording with the given url. || None || None ||
|| PUT || {{{http://<url>/record/<folder>/<id>/resume}}} || Resumes the recording with the given url. || None || None ||
|| GET || {{{http://<url>/record/<id>/acl/<acl-type>}}} || Gets the Access Control List of the recording.  The {{{<acl-type>}}} can be one of read, play or annotate.  || application/json, text/xml || The acl.  See below for details. ||
|| PUT || {{{http://<url>/record/<id>/acl/<acl-type>?<acl-details>}}} || Sets the recording ACL.  See below for details accepted. || None || None ||

== Recording List ==

=== XML ===
If text/xml is requested as the content type, the recording list will be produced as follows (note that the fields may appear in any order):

{{{
<recordings>

    <!-- 0 or more recordings -->
    <recording>
        
        <!-- The id of the recording -->
        <id>...</id>

        <metadata>
            
            <!-- The name of the recording -->
            <name>...</name>

            <!-- The description of the recording (optional) -->
            <description>...</description>

            <!-- True if the description is editable, false otherwise (optional) -->
            <descriptionEditable>...</descriptionEditable>
        </metadata>

        <!-- The date / time that the recording will start (see below for format) (optional) -->
        <startDate>...</startDate>

        <!-- The date / time that the recording will stop (see below for format) (optional) -->
        <stopDate>...</stopDate>

        <!-- The AGTk venue server that the venue to record from is on (optional) -->
        <ag3VenueServer>...</ag3VenueServer>
        
        <!-- The AGTk venue to record from (optional) -->
        <ag3VenueUrl>...</ag3VenueUrl>

        <!-- An address to record from (0 or more) -->
        <address>

             <!-- The IP address to record from -->
             <host>...</host>

             <!-- The port to record from -->
             <port>...</port>

             <!-- The ttl to record with -->
             <ttl>...</ttl>
        </address>
        ...
 
        <!-- The current status of the recording (see below) -->
        <status>...</status>

        <!-- The email address to notify when the recording is complete (optional) -->
        <emailAddress>...</emailAddress>
    </recording>
    
    ...
</recordings>
}}}

=== JSON ===
If application/json is requested as the content type, the recording list will be produced as follows (note that the fields may appear in any order):

{{{
{"recording":[
    
    /* 0 or more recordings */
    {

    /* The id of the recording */
    "id":"...",

    "metadata":
        {

        /* The name of the recording */
        "name":"...",

        /* The description of the recording (optional) */
        "description":"...",

        /* true if the description is editable, false otherwise (optional) */
        "descriptionEditable":...,
        },
    
    /* The date / time that the recording will start (see below for format) (optional) */
    "startDate":"..."

    /* The date / time that the recording will stop(see below for format) (optional) */
    "stopDate":"..."

    /* The AGTk venue server that the venue to record from is on (optional) */
    "ag3VenueServer":"..."

    /* The AGTk venue to record from (optional) */
    "ag3VenueUrl":"..."

    /* An address to record from (0 or more) */
    "address":[
        {

        /* The IP address to record from */
        "host":"...",
        
        /* The port to record from */
        "port":...,
        
        /* The ttl to record using */
        "ttl":...
        }
    ],
    ...

    /* The current status of the recording (see below) */
    "status":"..."

    /* The email address to notify when the recording is complete */
    "emailAddress":"..."
    },
    ...
]}
}}}

=== Recording Statuses ===
The recording status is formatted as a key word, optionally followed by additional information after a colon (which can be ignored), e.g. {{{status[:info]}}}.  The status can be one of the following:
 * Stopped - the recording has not yet started, or has finished but nothing was recorded
 * Recording - the recording is in progress
 * Paused - the recording has been paused
 * Completed - the recording has been completed (note that after this status has been read, the recording will no longer exist, and so will not appear in the next listing).
 * Error - there was an error performing the last command (or automatically starting or stopping)

== Recording Details ==
The recording details are specified as URL-Encoded parameters (e.g. key=value) passed after the url.  The following keys can be specified:
|| *Key* || *Description* || *Type* || *Count* || *Requirement* ||
|| metadata_name || The name of the recording || String || 1 || Required ||
|| metadata_description || The description of the recording || String || 0 or 1 || ||
|| startDate || The date and time at which to automatically start recording.  If not specified, the recording will have to be started manually. || Date / Time (see below) || 0 or 1 || ||
|| stopDate || The date and time at which to automatically stop recording.  If not specified, the recording will have to be stopped manually. || Date / Time (see below) || 0 or 1 || ||
|| ag3VenueServerUrl || The AG3 venue server that hosts the venue to record from. || URL of venue server. || 0 or 1 || Required if addresses not specified. ||
|| ag3VenueUrl || The AG3 venue to record from. || URL of venue. || 0 or 1 || Required if addresses not specified. ||
|| host || The IP address to record from. || IP address. || One for each address. || Required if venue not specified; One required for each address. ||
|| port || The port to record from. || Even number between 2 and 65534. || One for each address. || One required for each address. ||
|| ttl || The Time-to-live to record using. || Number between 0 and 256. || One for each address. || One required for each address. ||
|| emailAddress || An email address to notify when the recording is complete. || An e-mail address || 0 or 1 || ||

== Access Control List ==
If the return type is text/xml, the ACL will be formatted as follows:
{{{
<acl>
    
    <!-- True if the acl will allow access by default, false if it will deny -->
    <allow>...</allow>

    <!-- One for each exception -->
    <exception>

        <!-- The type of the exception, one of user, group or role -->
        <type>...</type>

        <!-- The username, group name or role of the exception -->
        <name>...</name>

    </exception>
    ...
    
</acl>
}}}

If the return type is application/json, the ACL will be formatted as follows:
{{{
{
    /* True if the acl will allow access by default, false if it will deny */
    "allow":"...",

    "exception":{[

        /* One for each exception */
        {

        /* The type of the exception, one of user, group or role */
        "type":"...",
        
        /* The username, group name or role of the exception */
        "name":"..."
        },
        ...
    ]}
}
}}}

== Access Control List Parameters ==
|| *Key* || *Description* || *Type* || *Count* || *Requirement* ||
|| public || true if the recording should be public, false otherwise || String || 1 || Required ||
|| exceptionType || The type of the corresponding exceptionName. One of user, group or role || String || 0 or more || Should be equal number of exceptionType and exceptionName parameters. ||
|| exceptionName || The username, group name or role of the exception || String || 0 or more || Should be equal number of exceptionType and exceptionName parameters. ||

== Date / Time Format ==
Dates and Times are represented as ISO8601 combined date time extended format without the timezone i.e. YYYY-MM-DDTHH:MM:SS.